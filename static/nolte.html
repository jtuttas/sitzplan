<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="Sitzplatzzuordnung an der MMBbS">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Sitzplatzzuordnung MMBbS Hannover</title>
    <!-- Favicons-->
    <link rel="apple-touch-icon" sizes="57x57" href="img/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="img/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="img/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="img/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="img/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="img/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="img/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="img/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="img/apple-icon-180x180.png">
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <link rel="icon" type="image/png" sizes="192x192" href="img/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="img/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="img/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="img/favicon-16x16.png">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="img/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <!-- jQuery, Bootstrap und CSS einbinden-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
        integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <link rel="stylesheet" href="main.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx"
        crossorigin="anonymous"></script>

</head>

<body class="text-center">
    <div class="form-signin bg-white rounded">
        <header>
            <img class="mb-4 mt-2" src="img/mmbbs-logo.svg" height="80"
                onerror="this.onerror=null; this.src='mmbbs-logo.svg'">
            <h1 class="h3">Sitzplatz zuordnen</h1>
        </header>
        <section id="formArea">
            <p><svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-upc-scan" fill="currentColor"
                    xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd"
                        d="M1.5 1a.5.5 0 0 0-.5.5v3a.5.5 0 0 1-1 0v-3A1.5 1.5 0 0 1 1.5 0h3a.5.5 0 0 1 0 1h-3zM11 .5a.5.5 0 0 1 .5-.5h3A1.5 1.5 0 0 1 16 1.5v3a.5.5 0 0 1-1 0v-3a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 1-.5-.5zM.5 11a.5.5 0 0 1 .5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 1 0 1h-3A1.5 1.5 0 0 1 0 14.5v-3a.5.5 0 0 1 .5-.5zm15 0a.5.5 0 0 1 .5.5v3a1.5 1.5 0 0 1-1.5 1.5h-3a.5.5 0 0 1 0-1h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 1 .5-.5z" />
                    <path
                        d="M3 4.5a.5.5 0 0 1 1 0v7a.5.5 0 0 1-1 0v-7zm2 0a.5.5 0 0 1 1 0v7a.5.5 0 0 1-1 0v-7zm2 0a.5.5 0 0 1 1 0v7a.5.5 0 0 1-1 0v-7zm2 0a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-7zm3 0a.5.5 0 0 1 1 0v7a.5.5 0 0 1-1 0v-7z" />
                </svg> Raum 206
            </p>
            <article>
                <form id="input-form" class="form-signin">
                    <label for="inputName" class="sr-only">Name</label>
                    <input type="name" id="inputName" class="form-control mb-2" placeholder="Vorname Nachname" required
                        autofocus>
                    <div class="checkbox mb-3">
                        <label>
                            <input id="c1" type="checkbox" value="remember-me"> Name merken
                        </label>
                    </div>
                    <button id="s1" class="btn btn-block btn-lg btn-primary"><span></span>Absenden</button>        
                </form>
            </article>
            <div id="successMsg" class="d-flex justify-content-center"></div>
        </section>
        <div id="errorMsg" class="d-flex justify-content-center"></div>
        <footer>
            <p class="mt-3 text-muted">&copy; 2020 MMBbS Hannover</p>
        </footer>
    </div>
</body>

<script>
    var url_string = window.location.href;
    var url = new URL(url_string);
    var id = url.searchParams.get("id");
    if (id == undefined) {
        $("#formArea").addClass("hidden");
        $("#errorMsg").show().text("Missing id Parameter").addClass("error");
    }
    else {
        console.log('ID=' + id);
        $("#s1").click(function (e) {
            if ($("#name").val() != "") {
                $("#s1").prop("disabled", true);
                $("#inputName").prop("disabled", true);
                $("#c1").prop("disabled", true);
                $("#s1").html('<span class="spinner-border spinner-border" role="status" aria-hidden="true"></span>');
                obj = {
                    name: $("#name").val(),
                    id: id
                }
                console.log('post:' + JSON.stringify(obj));
                $.ajax({
                    url: '/api/v1/',
                    type: 'post',
                    dataType: 'json',
                    contentType: 'application/json',
                    success: function (data) {
                        console.log('data=' + JSON.stringify(data));
                        $("#theform").addClass("hidden");
                        $("#result").removeClass("hidden");
                        $("#msg").text(data.msg);
                        if (data.success == true) {
                            $("#formArea article").fadeOut("slow", function () {
                                $("#successMsg").html('<svg class="checkmark" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52 52"><circle class="checkmark__circle" cx="26" cy="26" r="25" fill="none" /><path class="checkmark__check" fill="none" d="M14.1 27.2l7.1 7.2 16.7-16.8" /></svg>').addClass("success");
                            });
                            //window.location.replace('/web/thanks.html');
                            //window.location = "web/thanks.html";
                        }
                    },
                    data: JSON.stringify(obj)
                });
            }
        });
    }
</script>

</body>

</html>